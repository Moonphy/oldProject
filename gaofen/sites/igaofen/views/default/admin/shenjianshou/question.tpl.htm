<?php TPL::output('admin/global/header.tpl.htm'); ?>
<?php TPL::output('admin/global/nav_menu.tpl.htm'); ?>

<div class="aw-content-wrap">
    <div class="mod">
        <div class="mod-head">
            <h3>
                <span class="pull-left"><?php _e('神箭手问答设置');?></span>
            </h3>
        </div>
        <div class="tab-content mod-content">
            <form action="admin/shenjianshou/ajax_question/" method="post" id="config_form">
            <table class="table">
                <tbody>
                	<tr>
                   <td width="300">当前插件版本</td>
                   <td>v<?php _e($this->sjs_version);?>
                   	
                   	<span class="help-block"><?php _e('最新版本会定期在qq群174631869中发布'); ?></span>
                   	</td>
                   
                </tr>
                <tr>
                    <td>神箭手云采集官网</td>
                    <td><a href="http://www.shenjianshou.cn" target="_blank" style="text-decoration:underline;color:red;">点击前往&gt;&gt;</a></td>
                </tr>
                <tr>
                    <td>发布地址</td>
                    <td>
                        <input type="text" value="<?php echo base_url();?>/<?php echo G_INDEX_SCRIPT;?>shenjianshou/question/" style="width:400px;height:36px;padding-left:5px;" onclick="this.select()" readOnly="true" />
                    </td>
                </tr>
                <?php
                if(isset($this->sjs_tasks)){
                ?>
                <tr>
                    <td>绑定任务</td>
                    <td>
                        <select name="bind_task_id">
                        	<?php
                        	foreach($this->sjs_tasks as $task){
                        	?>
                        	<option value="<?php _e($task["task_id"]); ?>" <?=(($task["task_id"].""=="".$this->sjs_config['bind_task_id'])?"selected":"")?>><?php _e($task["task_name"]); ?></option>		
                        	<?php
                        	}
                        	?>
                        </select>
                        <span class="help-block"><?php _e('绑定任务后，在神箭手自动发布模块点击启动即可'); ?></span>
                    </td>
                </tr>
                 <?php
                }
                ?>
                <tr style="display:none">
                    <td><?php _e('字段映射');?></td>
                    <td>
                        <table class="table">
                            <tr>
                                <td><?php _e('问题');?></td>
                                <td><input type="text" name="question" <?php if(!empty($this->sjs_config['question'])){?>value="<?php echo $this->sjs_config['question'];?>" <?php }?>/></td>
                            </tr>
                            <tr>
                                <td><?php _e('问题作者');?></td>
                                <td><input type="text" name="question_author" <?php if(!empty($this->sjs_config['question_author'])){?>value="<?php echo $this->sjs_config['question_author'];?>" <?php }?>/></td>
                            </tr>
                            <tr>
                                <td><?php _e('问题作者头像');?></td>
                                <td><input type="text" name="question_avatar" <?php if(!empty($this->sjs_config['question_avatar'])){?>value="<?php echo $this->sjs_config['question_avatar'];?>" <?php }?>/></td>
                            </tr>
                            <tr>
                                <td><?php _e('问题描述');?></td>
                                <td><input type="text" name="question_detail" <?php if(!empty($this->sjs_config['question_detail'])){?>value="<?php echo $this->sjs_config['question_detail'];?>" <?php }?>/></td>
                            </tr>
                            
                            <tr>
                                <td><?php _e('问题发布时间');?></td>
                                <td><input type="text" name="question_time" <?php if(!empty($this->sjs_config['question_time'])){?>value="<?php echo $this->sjs_config['question_time'];?>" <?php }?>/></td>
                            </tr>
                            
                            <tr>
                                <td><?php _e('话题');?></td>
                                <td><input type="text" name="topics" <?php if(!empty($this->sjs_config['topics'])){?>value="<?php echo $this->sjs_config['topics'];?>" <?php }?>/></td>
                            </tr>
                            <tr>
                                <td><?php _e('回复');?></td>
                                <td><input type="text" name="answers" <?php if(!empty($this->sjs_config['answers'])){?>value="<?php echo $this->sjs_config['answers'];?>" <?php }?>/></td>
                            </tr>
                            <tr>
                                <td>回复子项</td>
                                <td>
                                    <table class="table">
                                        <tr>
                                            <td><?php _e('回复内容');?></td>
                                            <td><input type="text" name="content" <?php if(!empty($this->sjs_config['content'])){?>value="<?php echo $this->sjs_config['content'];?>" <?php }?>/></td>
                                        </tr>
                                        <tr>
                                            <td><?php _e('回复作者');?></td>
                                            <td><input type="text" name="author" <?php if(!empty($this->sjs_config['author'])){?>value="<?php echo $this->sjs_config['author'];?>" <?php }?>/></td>
                                        </tr>
                                        <tr>
                                            <td><?php _e('回复作者头像');?></td>
                                            <td><input type="text" name="avatar" <?php if(!empty($this->sjs_config['avatar'])){?>value="<?php echo $this->sjs_config['avatar'];?>" <?php }?>/></td>
                                        </tr>
                                        <tr>
                                            <td><?php _e('回复时间');?></td>
                                            <td><input type="text" name="publish_time" <?php if(!empty($this->sjs_config['publish_time'])){?>value="<?php echo $this->sjs_config['publish_time'];?>" <?php }?>/></td>
                                        </tr>
                                        <tr>
                                            <td><?php _e('回复赞同数');?></td>
                                            <td><input type="text" name="agree_count" <?php if(!empty($this->sjs_config['agree_count'])){?>value="<?php echo $this->sjs_config['agree_count'];?>" <?php }?>/></td>
                                        </tr>
                                        <tr>
                                            <td><?php _e('回复的评论');?></td>
                                            <td><input type="text" name="comments" <?php if(!empty($this->sjs_config['comments'])){?>value="<?php echo $this->sjs_config['comments'];?>" <?php }?>/></td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td><?php _e('作者');?></td>
                    <td style="line-height:30px;">
                        <input type="radio" name="user_config" value="0" <?php if(!$this->sjs_config['use_authors']){?>checked="checked" <?php }?>/><?php _e('全部使用匿名用户');?><br />
                        <input type="radio" name="user_config" value="1" <?php if($this->sjs_config['use_authors']){?>checked="checked" <?php }?>/><?php _e('根据抓取结果插入用户');?>
                    </td>
                </tr>
                <tr>
                    <td><?php _e('用户头像');?></td>
                    <td style="line-height:30px;">
                        <input type="checkbox" name="avatar_config" <?php if($this->sjs_config['use_avatars']){?>checked="checked"<?php }?>/><?php _e('使用抓取到的用户头像');?>
                    </td>
                </tr>
                <tr>
                    <td><?php _e('发布时间');?></td>
                    <td style="line-height:30px;">
                        <input type="checkbox" name="pubtime_config" <?php if($this->sjs_config['use_pubtime']){?>checked="checked"<?php }?>/><?php _e('使用抓取到的发布时间作为插入时间');?>
                    		<span class="help-block"><?php _e('不勾选则使用发布到网站的时间'); ?></span>
                    </td>
                </tr>
                <tr>
                    <td><?php _e('话题选项');?></td>
                    <td style="line-height:30px;">
                        <input type="checkbox" name="topic_config" <?php if($this->sjs_config['use_topics']){?>checked="checked"<?php }?>/><?php _e('抓取的话题自动插入数据库');?>
                    </td>
                </tr>
                 <tr>
                    <td><?php _e('分类选项');?></td>
                    <td style="line-height:30px;">
                        <input type="radio" name="custome_category_config" value="1" <?php if($this->sjs_config['custome_category_config']==1){?>checked="checked" <?php }?>/><?php _e('使用采集到的分类，如没有则不设置分类');?><br />
                        <input type="radio" name="custome_category_config" value="2" <?php if($this->sjs_config['custome_category_config']==2){?>checked="checked" <?php }?>/><?php _e('发布到指定分类');?>&nbsp;
                        <select name="custome_category">
                        <?php
                        foreach($this->categories as $category){
                        ?>
                        <option value="<?php _e($category["id"]); ?>" <?php if(intval($this->sjs_config['custome_category']) == $category["id"]) echo "selected";?> ><?php _e($category["title"]); ?></option>
                        <?php
                     		 }
                        ?>
                      	</select>
                    </td>
                </tr>
                <tr>
                    <td><?php _e('评论选项');?></td>
                    <td style="line-height:30px;">
                        <input type="checkbox" name="comments_config" <?php if($this->sjs_config['use_comments']){?>checked="checked"<?php }?>/><?php _e('抓取针对答案的评论');?>
                    		<span class="help-block"><?php _e('采集端部分模板支持该选项'); ?></span>
                    </td>
                </tr>
                
                </tbody>
                <tfoot>
                <tr>
                <td colspan="2">
                <input type="button" value="<?php _e('保存设置'); ?>" class="btn btn-primary center-block" onclick="AWS.ajax_post($('#config_form'));" />
                </td>
                </tr>
                </tfoot>
            </table>
            </form>
        </div>
    </div>
</div>

<?php TPL::output('admin/global/footer.tpl.htm'); ?>
